<!DOCTYPE html>
<html>
	<head>
		<title>3DGlobe</title>
		<style type="text/css">
			html, body {margin: 0; padding: 0; overflow: hidden;}
		</style>
	</head>
	<body>
		<script type="text/javascript" src="js/three.min.js"></script>
		<script language="javascript" type="text/javascript" src="geocentric.js"></script>
		<script language="javascript" type="text/javascript" src="jsonloader.js"></script>
		<script type="text/javascript">

		var renderer, scene, camera,
			width = window.innerWidth,
			height = window.innerHeight,
			coastlines;

		fetchJSONFile('coastlines.geojson', function(data){
		    coastlines = data.features;
		    console.log("geoJSON loaded\ncalculating geocentric coordinates");

	    	theEllipsoid = new Ellipsoid();
	
			for(var feature = 0; feature < coastlines.length; feature++){
				var geometry = coastlines[feature].geometry.coordinates;
				for(var pair = 0; pair < geometry.length; pair += 1){
					var lat = geometry[pair][1];
					var lon = geometry[pair][0];
					lon *= -1;
					var coordinates = theEllipsoid.getGeocentric(lat, lon, 0);
					for(var i = 0; i < coordinates.length; i++){
						coordinates[i] = map(coordinates[i], 0, theEllipsoid.a, 0, 300); //THIS NUMBER???
					}
					geometry[pair][0] = coordinates[0];
					geometry[pair][1] = coordinates[1];
					geometry[pair][2] = coordinates[2];
				}
			}

		    init();
		});

		function init(){
			renderer = new THREE.WebGLRenderer();
			renderer.setSize(width, height);
			document.body.appendChild(renderer.domElement);

			camera = new THREE.PerspectiveCamera(45, width / height, 1, 500);

			camera.position.set(0, 0, 100);
			camera.lookAt(new THREE.Vector3(0, 0, 0));

			scene = new THREE.Scene();
		}

		function animate(){
			requestAnimationFrame(animate);

			//movement stuff

			render();
		}

		function render(){
			renderer.render(scene, camera);
		}



		</script>
	</body> 
</html>